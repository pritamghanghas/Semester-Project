<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.6"/>
<title>SkyeControls: Simulation Framework For Skye</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="rsz_skye.jpg"/></td>
  <td style="padding-left: 0.5em;">
   <div id="projectname">SkyeControls
   &#160;<span id="projectnumber">1.00</span>
   </div>
   <div id="projectbrief">...</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.6 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li class="current"><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Classes</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Namespaces</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Pages</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">Simulation Framework For <a class="el" href="class_skye.html">Skye</a> </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p>This repository contains everything you need to simulate the airship <a class="el" href="class_skye.html">Skye</a> in <a href="http://gazebosim.org/">Gazebo</a> and interact with it by using the Robotic Operating System <a href="http://www.ros.org/">ROS</a>. The recommended OS is Ubuntu 14.04.</p>
<h2>ROS Installation</h2>
<p>These steps are taken from the main installation page of ROS. Configure your Ubuntu repositories to allow "restricted," "universe," and "multiverse." You can <a href="https://help.ubuntu.com/community/Repositories/Ubuntu">follow the Ubuntu guide</a> for instructions on doing this. Setup your computer to accept software from packages.ros.org. ROS Indigo ONLY supports Saucy (13.10) and Trusty (14.04) for debian packages. ```bash sudo sh -c 'echo "deb http://packages.ros.org/ros/ubuntu $(lsb_release -sc) main" &gt; /etc/apt/sources.list.d/ros-latest.list' ``` Set up your keys ```bash sudo apt-key adv &ndash;keyserver hkp://ha.pool.sks-keyservers.net &ndash;recv-key 0xB01FA116 ``` Installation: first, make sure your Debian package index is up-to-date. ```bash sudo apt-get update ``` Install the Desktop Install version, which provides you: ROS, rqt, rviz, and robot-generic libraries ```bash sudo apt-get install ros-indigo-desktop ``` Initialize ROS. ```bash sudo rosdep init rosdep update ``` It's convenient if the ROS environment variables are automatically added to your bash session every time a new shell is launched: ```bash echo "source /opt/ros/indigo/setup.bash" &gt;&gt; ~/.bashrc source ~/.bashrc ``` rosinstall is a frequently used command-line tool in ROS that is distributed separately. It enables you to easily download many source trees for ROS packages with one command. ```bash sudo apt-get install python-rosinstall ``` </p>
<h2>Gazebo6 Installation</h2>
<p>Since some of the required plugins are not available in Gazebo2 (the official supported version of Gazebo in ROS Indigo) it is necessary to manually install Gazebo6 and its integration with ROS. To do so setup your computer to accept software from packages.osrfoundation.org. ``<code>bash sudo sh -c 'echo "deb http://packages.osrfoundation.org/gazebo/ubuntu-stable&lt;/tt&gt;lsb_release -cs` main" &gt; /etc/apt/sources.list.d/gazebo-stable.list' ``` Setup keys ```bash wget <a href="http://packages.osrfoundation.org/gazebo.key">http://packages.osrfoundation.org/gazebo.key</a> -O - | sudo apt-key add - ``` Install Gazebo with ROS integration. ```bash sudo apt-get update sudo apt-get install ros-indigo-gazebo6-ros-pkgs ```</code></p>
<p><code></p>
<h2>Test Gazebo-ROS Integration</h2>
<p></code></p>
<p><code> Make sure the stand-alone Gazebo works by running in terminal (this command may need a couple of minutes the first time your run it): ```bash gazebo ``` You should see the GUI open with an empty world. Also, test adding a model by clicking on the "Insert" tab on the left and selecting a model to add (then clicking on the simulation to select where to place the model). Now you can close Gazebo and you can kill all of its processes by ```bash killall -9 gazebo &amp; killall -9 gzserver &amp; killall -9 gzclient ``` Finally we can test Gazebo with ROS Integration. ```bash roscore &amp; rosrun gazebo_ros gazebo ``` The Gazebo GUI should appear with nothing inside the viewing window. To verify that the proper ROS connections are setup, view the available ROS topics by typing in a new terminal the command ```bash rostopic list ``` You should see within the lists topics such as: ```bash /gazebo/link_states /gazebo/model_states /gazebo/parameter_descriptions /gazebo/parameter_updates /gazebo/set_link_state /gazebo/set_model_state ``` Now you can close Gazebo. To Make sure every processes started from the previous command has been closed you can run ```bash killall -9 gazebo &amp; killall -9 gzserver &amp; killall -9 gzclient ```</code></p>
<p><code></p>
<h2>Create A Catkin Workspace And Compile Source Code</h2>
<p></code></p>
<p><code> Create a catkin workspace in your home folder where you are going to clone every package needed to simulate <a class="el" href="class_skye.html">Skye</a>. ```bash cd ~ mkdir -p catkin_ws/src cd ~/catkin_ws/src catkin_init_workspace ``` Clone the required reposotories in the src folder: ```bash cd ~/catkin_ws/src git clone <a href="https://github.com/skye-git/skye_gazebo_simulation">https://github.com/skye-git/skye_gazebo_simulation</a> -b indigo-devel git clone <a href="https://github.com/skye-git/hector_gazebo">https://github.com/skye-git/hector_gazebo</a> -b indigo-devel ``<code> Compile them. Suggestion: use the option **-j** to specify the number of jobs to run simultaneously; for example</code>catkin_make -j4<code> </code>``bash cd ~/catkin_ws catkin_make ``` It's convenient if the ROS environment variables are automatically added to your bash session every time a new shell is launched: ```bash echo "source ~/catkin_ws/devel/setup.bash" &gt;&gt; ~/.bashrc source ~/.bashrc ```</code></p>
<p><code></p>
<h2>Include Needed Plugins</h2>
<p></code></p>
<p><code> To include the needed plugins in Gazebo6 you first must locate the Gazebo setup.sh file: ```bash &lt;install_path&gt;/share/gazebo/setup.sh ``` where *&lt;install_path&gt;* is the path where Gazebo has been installed in your computer. For example the previous command should look similar to ```bash /usr/share/gazebo/setup.sh ``` Now you can modify the path where Gazebo searchs for the plugin shared libraries at runtime. The Imu plugin from "hector_gazebo" package is located, by default, in '~/catkin_ws/devel/lib/'. ```bash echo "source &lt;install_path&gt;/share/gazebo/setup.sh" &gt;&gt; ~/.bashrc echo "export GAZEBO_PLUGIN_PATH=~/catkin_ws/devel/lib:${GAZEBO_PLUGIN_PATH}" &gt;&gt; ~/.bashrc source ~/.bashrc ```</code></p>
<p><code></p>
<h2>Launch A Simulation With Empty World</h2>
<p></code></p>
<p><code> To launch a first simulation of <a class="el" href="class_skye.html">Skye</a> in an empty world in Gazebo type ```bash roslaunch <a class="el" href="namespaceskye__ros.html">skye_ros</a> inflate_skye.launch ``` The launch file 'inflate_skye.launch' does several things for you: it starts roscore, launches Gazebo with an instance of <a class="el" href="class_skye.html">Skye</a> and starts the node interface called 'skye_ros_node'.</code></p>
<p><code></p>
<h2>Skye-ROS Interface</h2>
<p></code></p>
<p><code> The package "skye_ros" provides an easy interface to interact with a simulation of <a class="el" href="class_skye.html">Skye</a> in Gazebo.</code></p>
<p><code></p>
<h3>Advertised Topics</h3>
<p></code></p>
<p><code></p>
<ul>
<li>/skye_ros/sensor_msgs/imu_sk IMU data expressed in a local frame attached to the IMU box, called IMU frame. See section <em>Frame Convetions</em> for further information.</li>
<li>/skye_ros/ground_truth/hull ground truth infomration of the hull. Contains the position, orientation and linear velocity of the hull, expressed in the world NED frame (see below section <b>Frames Convetion</b> for further information). <b>Warning</b>: angular velocity field into this topic is filled with zeros as long as a problem in Gazebo is not resolved.</li>
</ul>
<p></code></p>
<p><code>Example: echo imu_sk message. ```bash rostopic echo /skye_ros/sensor_msgs/imu_sk ```</code></p>
<p><code></p>
<h3>Advertised Services</h3>
<p></code></p>
<p><code></p>
<ul>
<li>/skye_ros/apply_wrench_cog_bf service to apply a wrench (i.e. a force and a torque) in the center of gravity (CoG) of <a class="el" href="class_skye.html">Skye</a>. Wrench expressed in <a class="el" href="class_skye.html">Skye</a>'s body frame attached to the CoG of <a class="el" href="class_skye.html">Skye</a>. See below section <b>Frames Convetion</b> for further information.</li>
</ul>
<p></code></p>
<p><code>Example: apply a torque of 3 Nm around <a class="el" href="class_skye.html">Skye</a>'s X axes (in body frame). ```bash rosservice call /skye_ros/apply_wrench_cog_bf '{wrench: { force: { x: 0, y: 0, z: 0 }, torque: {x: 3, y: 0, z: 0} }, start_time: 0, duration: -1 }' ``` </p>
<h2>Repository Layout</h2>
<p></code></p>
<p><code> The following describes the directory structure and important files in the skye_gazebo_simulation repository</code></p>
<p><code>Folders:</code></p>
<p><code></p>
<ul>
<li>skye_description - <a class="el" href="class_skye.html">Skye</a>'s Gazebo model descritpion in SDF.</li>
<li>skye_gazebo - Contains launch files to run Gazebo and spawn <a class="el" href="class_skye.html">Skye</a>.</li>
<li><a class="el" href="namespaceskye__ros.html">skye_ros</a> - Containes a simple interface which converts data from Gazebo ENU frame to <a class="el" href="class_skye.html">Skye</a>'s NED frame.</li>
</ul>
<p></code></p>
<p><code></p>
<h2>Frames Convention</h2>
<p></code></p>
<p><code> Gazebo and ROS use ENU frame convention, i.e. X axis points to East, Y axis to North and Z axis up. We use trhee slightly different frames, that are common in air vehicles: r</code></p>
<p><code></p>
<ul>
<li>World NED frame: X axis pointing to North, Y axis pointing to East and Z axis pointing to Down.</li>
<li><a class="el" href="class_skye.html">Skye</a>'s body frame: frame attached to the Center of Gravity (CoG) of the hull. It has the X axis pointing geometrically forward W.R.T the eye, the Y axis pointing geometrically right W.R.T the hull and the Z axis pointing geometrically down W.R.T the hull.</li>
<li>IMU frame: frame attached to the center of the IMU (red box). It has the X axis pointing geometrically forward W.R.T the eye, the Y axis pointing geometrically right W.R.T the hull and the Z axis pointing geometrically down W.R.T the hull.</li>
</ul>
<p></code></p>
<p><code>The picture below gives an overview of these three frames. Note that the initial default position of <a class="el" href="class_skye.html">Skye</a> is rotated of 90 degrees about the Z axis with respect to the world NED frame.</code></p>
<p><code></code></p>
<p><code> </p>
<div class="image">
<img src="skye_ros/doc/frames.png"  width="650"/>
</div>
<p> </code></p>
<p><code> </code></p>
</div></div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Sun Apr 17 2016 13:43:57 for SkyeControls by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.6
</small></address>
</body>
</html>
